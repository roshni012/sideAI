<!-- Chat Tab Component HTML -->
<!-- Welcome Section -->
<div class="sider-welcome">
  <h3>Hi,</h3>
  <p>How can I assist you today?</p>
  
  <div class="sider-action-buttons">
    <button class="sider-action-btn" data-action="fullscreen">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
        <line x1="7" y1="8" x2="17" y2="8"/>
        <line x1="7" y1="12" x2="17" y2="12"/>
        <line x1="7" y1="16" x2="15" y2="16"/>
      </svg>
      <span>Full Screen Chat</span>
    </button>
    <button class="sider-action-btn" data-action="research">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="11" cy="11" r="8"/>
        <path d="m21 21-4.35-4.35"/>
      </svg>
      <span>Deep Research</span>
    </button>
    <button class="sider-action-btn" data-action="highlights">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <rect x="5" y="2" width="14" height="20" rx="2" ry="2"/>
        <line x1="12" y1="18" x2="12" y2="18"/>
        <path d="M9 6h6M9 10h6M9 14h4"/>
        <path d="M19 6h2v2h-2z"/>
      </svg>
      <span>My Highlights</span>
    </button>
    <button class="sider-action-btn" data-action="slides">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <rect x="3" y="3" width="18" height="14" rx="2" ry="2"/>
        <line x1="8" y1="21" x2="16" y2="21"/>
        <line x1="12" y1="17" x2="12" y2="21"/>
        <rect x="6" y="6" width="12" height="6" rx="1"/>
        <line x1="6" y1="9" x2="18" y2="9"/>
      </svg>
      <span>AI Slides</span>
    </button>
  </div>
</div>

<!-- Summarize Card (only in chat-tab) -->
<div class="sider-summarize-card" id="sider-summarize-card" style="display: none;">
  <div class="sider-summarize-card-left">
    <div class="sider-summarize-icon" id="sider-summarize-icon">
      <img id="sider-summarize-favicon" src="" alt="" style="display: none; width: 20px; height: 20px; border-radius: 4px; object-fit: contain;" />
      <svg id="sider-summarize-icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <circle cx="12" cy="12" r="10" fill="#8b5cf6"/>
        <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z" fill="#ffffff" opacity="0.3"/>
        <line x1="2" y1="12" x2="22" y2="12" stroke="#ffffff" stroke-width="2"/>
      </svg>
    </div>
    <span class="sider-summarize-site-name" id="sider-summarize-site-name"></span>
  </div>
  <div class="sider-summarize-card-right">
    <button class="sider-summarize-btn" id="sider-summarize-btn" data-action="summarize">
      <svg class="sider-summarize-sparkle" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 2L13.5 8.5L20 10L13.5 11.5L12 18L10.5 11.5L4 10L10.5 8.5L12 2Z"/>
      </svg>
      <span>Summarize</span>
    </button>
    <button class="sider-summarize-save-btn" id="sider-summarize-save-btn" title="Save">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
        <polyline points="17 21 17 13 7 13 7 21"/>
        <polyline points="7 3 7 8 15 8"/>
      </svg>
    </button>
    <button class="sider-summarize-close-btn" id="sider-summarize-close-btn" title="Close">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="18" y1="6" x2="6" y2="18"/>
        <line x1="6" y1="6" x2="18" y2="18"/>
      </svg>
    </button>
  </div>
</div>

<div class="sider-chat-container" id="sider-chat-container" style="display: none;">
  <div class="sider-chat-messages" id="sider-chat-messages"></div>
</div>

<div class="sider-panel-footer">
  <div class="sider-input-wrapper">
    <div class="sider-toolbar">
      <button class="sider-toolbar-btn sider-ai-selector-btn" id="sider-ai-selector-btn" title="Select AI Model">
        <div class="sider-ai-selector-icon">
          <img id="sider-ai-icon-img" src="" alt="AI Model" style="width: 18px; height: 18px; object-fit: contain; display: block;" />
        </div>
        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="sider-dropdown-arrow">
          <polyline points="6 9 12 15 18 9"/>
        </svg>
      </button>
      <button class="sider-toolbar-btn" id="sider-screenshot-btn" title="Capture Selected Area">
        <img id="sider-screenshot-icon" src="" alt="Cut" style="width: 18px; height: 18px; object-fit: contain;" />
      </button>
      <button class="sider-toolbar-btn" id="sider-attach-btn" title="Attach File">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"/>
        </svg>
      </button>
      <button class="sider-toolbar-btn" id="sider-read-page-btn" title="Read This Page">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/>
          <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/>
          <line x1="8" y1="7" x2="16" y2="7"/>
          <line x1="8" y1="11" x2="16" y2="11"/>
        </svg>
      </button>
      <button class="sider-toolbar-btn" id="sider-filter-btn" title="Chat control">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="3" y1="6" x2="21" y2="6"/>
          <line x1="7" y1="12" x2="17" y2="12"/>
          <line x1="11" y1="18" x2="13" y2="18"/>
        </svg>
        <span class="sider-notification-dot"></span>
      </button>
      <button class="sider-toolbar-btn" id="sider-history-btn" title="Chat History">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"/>
          <polyline points="12 6 12 12 16 14"/>
        </svg>
      </button>
      <button class="sider-toolbar-btn" id="sider-new-chat-btn" title="New Chat">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="12" y1="5" x2="12" y2="19"/>
          <line x1="5" y1="12" x2="19" y2="12"/>
        </svg>
      </button>
    </div>
    <div class="sider-ai-dropdown" id="sider-ai-dropdown" style="display: none;">
      <div class="sider-ai-dropdown-section">
        <div class="sider-ai-dropdown-title">Basic</div>
        <div class="sider-ai-option" data-model="chatgpt">
          <div class="sider-ai-option-icon">ü§ñ</div>
          <span>GPT-3.5</span>
        </div>
        <div class="sider-ai-option" data-model="gpt4">
          <div class="sider-ai-option-icon">üß†</div>
          <span>GPT-4</span>
        </div>
        <div class="sider-ai-option" data-model="gemini">
          <div class="sider-ai-option-icon">‚≠ê</div>
          <span>Gemini</span>
        </div>
        <div class="sider-ai-option" data-model="claude">
          <div class="sider-ai-option-icon">üåü</div>
          <span>Claude</span>
        </div>
      </div>
    </div>
    <div class="sider-input-area">
      <div class="sider-image-preview-section" id="sider-image-preview-section" style="display: none;">
        <div style="display: flex; flex-direction: column; align-items: flex-start; gap: 8px; margin-bottom: 8px; width: 100%;">
          <div class="sider-images-row" style="display: flex; flex-direction: row; gap: 8px; align-items: flex-start; flex-wrap: wrap;">
          </div>
          <div style="display: flex; flex-direction: row; gap: 8px; align-items: flex-start; flex-wrap: wrap;">
            <button class="sider-image-action-btn" data-action="extract-text" style="background: #f3f4f6; border: 1px solid #e5e7eb; border-radius: 6px; padding: 6px 12px; font-size: 10px; font-weight: 500; color: #111827; cursor: pointer; transition: all 0.2s; white-space: nowrap;">
              Extract text
            </button>
            <button class="sider-image-action-btn" data-action="math-solver" style="background: #f3f4f6; border: 1px solid #e5e7eb; border-radius: 6px; padding: 6px 12px; font-size: 10px; font-weight: 500; color: #111827; cursor: pointer; transition: all 0.2s; white-space: nowrap;">
              Math Solver
            </button>
            <button class="sider-image-action-btn" data-action="translate-image" style="background: #f3f4f6; border: 1px solid #e5e7eb; border-radius: 6px; padding: 6px 12px; font-size: 10px; font-weight: 500; color: #111827; cursor: pointer; transition: all 0.2s; white-space: nowrap; display: flex; align-items: center; gap: 4px; position: relative;">
              <span class="sider-translate-text">Translate</span>
              <svg class="sider-translate-arrow" width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="cursor: pointer;">
                <polyline points="6 9 12 15 18 9"/>
              </svg>
              <div class="sider-translate-language-dropdown" id="sider-translate-language-dropdown" style="display: none;">
                <div class="sider-translate-language-list">
                  <div class="sider-translate-language-item" data-lang="en" data-lang-name="English">English</div>
                  <div class="sider-translate-language-item" data-lang="es-co" data-lang-name="Spanish (Colombia)">Spanish (Colombia)</div>
                  <div class="sider-translate-language-item" data-lang="es" data-lang-name="European Spanish">European Spanish</div>
                  <div class="sider-translate-language-item" data-lang="es-mx" data-lang-name="Mexican Spanish">Mexican Spanish</div>
                  <div class="sider-translate-language-item" data-lang="fr" data-lang-name="French">French</div>
                  <div class="sider-translate-language-item" data-lang="ja" data-lang-name="Japanese">Japanese</div>
                  <div class="sider-translate-language-item" data-lang="pt" data-lang-name="Portuguese">Portuguese</div>
                  <div class="sider-translate-language-item" data-lang="pt-br" data-lang-name="Brazilian Portuguese">Brazilian Portuguese</div>
                  <div class="sider-translate-language-item" data-lang="de" data-lang-name="German">German</div>
                  <div class="sider-translate-language-item" data-lang="it" data-lang-name="Italian">Italian</div>
                  <div class="sider-translate-language-item" data-lang="ru" data-lang-name="Russian">Russian</div>
                  <div class="sider-translate-language-item" data-lang="ko" data-lang-name="Korean">Korean</div>
                  <div class="sider-translate-language-item" data-lang="zh" data-lang-name="Chinese">Chinese</div>
                  <div class="sider-translate-language-item" data-lang="ar" data-lang-name="Arabic">Arabic</div>
                  <div class="sider-translate-language-item" data-lang="hi" data-lang-name="Hindi">Hindi</div>
                  <div class="sider-translate-language-item" data-lang="nl" data-lang-name="Dutch">Dutch</div>
                  <div class="sider-translate-language-item" data-lang="pl" data-lang-name="Polish">Polish</div>
                  <div class="sider-translate-language-item" data-lang="tr" data-lang-name="Turkish">Turkish</div>
                  <div class="sider-translate-language-item" data-lang="vi" data-lang-name="Vietnamese">Vietnamese</div>
                  <div class="sider-translate-language-item" data-lang="th" data-lang-name="Thai">Thai</div>
                  <div class="sider-translate-language-item" data-lang="id" data-lang-name="Indonesian">Indonesian</div>
                </div>
              </div>
            </button>
          </div>
        </div>
      </div>
      <div class="sider-selected-text-section" id="sider-selected-text-section" style="display: none;">
        <div class="sider-selected-text-header">
          <span class="sider-selected-text-title">Text from your selection</span>
          <button id="sider-remove-selection-btn" class="sider-remove-selection-btn" title="Close">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="18" y1="6" x2="6" y2="18"/>
              <line x1="6" y1="6" x2="18" y2="18"/>
            </svg>
          </button>
        </div>
        <div id="sider-selected-text-display" class="sider-selected-text-display"></div>
        <div class="sider-selection-actions" id="sider-selection-actions">
          <button class="sider-action-btn" data-action="explain">
            <span>Explain</span>
          </button>
          <button class="sider-action-btn" data-action="translate">
            <span>Translate</span>
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polyline points="6 9 12 15 18 9"/>
            </svg>
          </button>
          <button class="sider-action-btn" id="sider-more-actions-btn">
            <span>...</span>
          </button>
        </div>
        <div class="sider-selection-divider"></div>
      </div>
      <div class="sider-attachments" id="sider-attachments"></div>
      <textarea 
        id="sider-chat-input" 
        class="sider-chat-input" 
        placeholder="Ask anything, @models, / prompts"
        rows="1"
      ></textarea>
      <div class="sider-input-buttons">
        <div class="sider-input-buttons-left">
          <button class="sider-bottom-action-btn" data-action="think" disabled>
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <line x1="12" y1="6" x2="12" y2="8"/>
              <line x1="12" y1="16" x2="12" y2="18"/>
              <path d="M9 9h6M9 15h6"/>
            </svg>
            <span>Think</span>
          </button>
          <button class="sider-bottom-action-btn" data-action="deep-research" disabled>
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"/>
              <path d="m21 21-4.35-4.35"/>
            </svg>
            <span>Deep Research</span>
          </button>
        </div>
        <button class="sider-mic-btn" id="sider-mic-btn" title="Voice Input" style="display: none;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/>
            <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
            <line x1="12" y1="19" x2="12" y2="23"/>
            <line x1="8" y1="23" x2="16" y2="23"/>
          </svg>
        </button>
        <button class="sider-send-btn" id="sider-send-btn" title="Send" style="display: none;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="22" y1="2" x2="11" y2="13"/>
            <polygon points="22 2 15 22 11 13 2 9 22 2"/>
          </svg>
        </button>
        <button class="sider-stop-btn" id="sider-stop-btn" title="Stop generating" style="display: none;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="6" y="6" width="12" height="12" rx="2"/>
          </svg>
        </button>
      </div>
    </div>
  </div>
  <input type="file" id="sider-file-input" style="display: none;" multiple>
</div>

<!-- Chat History Modal -->
<div class="sider-chat-history-modal" id="sider-chat-history-modal" style="display: none;">
  <div class="sider-chat-history-modal-content">
    <div class="sider-chat-history-header">
      <h2 class="sider-chat-history-title">Chat history <span class="sider-chat-history-count" id="sider-chat-history-count">(0)</span></h2>
      <button class="sider-chat-history-close" id="sider-chat-history-close" title="Close">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"/>
          <line x1="6" y1="6" x2="18" y2="18"/>
        </svg>
      </button>
    </div>
    <div class="sider-chat-history-tabs">
      <button class="sider-chat-history-tab active" data-tab="all">All</button>
      <button class="sider-chat-history-tab" data-tab="starred">Starred</button>
    </div>
    <div class="sider-chat-history-search-wrapper">
      <div class="sider-chat-history-search">
        <svg class="sider-chat-history-search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="11" cy="11" r="8"/>
          <path d="m21 21-4.35-4.35"/>
        </svg>
        <input type="text" class="sider-chat-history-search-input" id="sider-chat-history-search-input" placeholder="Search" />
      </div>
      <button class="sider-chat-history-delete-all" id="sider-chat-history-delete-all" title="Delete All">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="3 6 5 6 21 6"/>
          <path d="m19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
        </svg>
        <span>All</span>
      </button>
    </div>
    <div class="sider-chat-history-list" id="sider-chat-history-list">
      <!-- Conversations will be dynamically loaded here -->
    </div>
  </div>
</div>

<!-- Delete Confirmation Modal -->
<div class="sider-delete-confirmation-modal" id="sider-delete-confirmation-modal" style="display: none;">
  <div class="sider-delete-confirmation-content">
    <div class="sider-delete-confirmation-header">
      <h3 class="sider-delete-confirmation-title">Delete Conversation</h3>
    </div>
    <div class="sider-delete-confirmation-body">
      <p class="sider-delete-confirmation-message">Are you sure you want to delete this conversation?</p>
    </div>
    <div class="sider-delete-confirmation-actions">
      <button class="sider-delete-confirmation-btn sider-delete-confirmation-cancel">Cancel</button>
      <button class="sider-delete-confirmation-btn sider-delete-confirmation-confirm">Delete</button>
    </div>
  </div>
</div>

<!-- Edit Title Modal -->
<div class="sider-edit-title-modal" id="sider-edit-title-modal" style="display: none;">
  <div class="sider-edit-title-content">
    <div class="sider-edit-title-header">
      <h3 class="sider-edit-title-title">Edit Title</h3>
    </div>
    <div class="sider-edit-title-body">
      <input 
        type="text" 
        class="sider-edit-title-input" 
        id="sider-edit-title-input" 
        placeholder="Enter new title"
        maxlength="100"
      />
    </div>
    <div class="sider-edit-title-actions">
      <button class="sider-edit-title-btn sider-edit-title-cancel">Cancel</button>
      <button class="sider-edit-title-btn sider-edit-title-confirm">Save</button>
    </div>
  </div>
</div>

